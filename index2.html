<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dua Lipa — Houdini Player</title>
<link rel="icon" href="radical_optimism.jpg" type="image/x-icon">
<style>
  /* Reset & base */
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;font-family:Inter,Arial,sans-serif;background:#0f4f54;color:#fff;-webkit-font-smoothing:antialiased;}
  button{cursor:pointer;border:0;background:transparent;color:inherit;font:inherit}

  /* Header (bio + album) */
  header{padding:40px 20px;text-align:center;background:#0f4f54}
  header .hero{width:220px;height:220px;border-radius:50%;object-fit:cover;box-shadow:0 16px 60px rgba(0,0,0,.5);display:block;margin:0 auto 18px}
  header h1{font-size:2rem;margin-bottom:10px}
  header p{max-width:900px;margin:0 auto;color:#e6f7f6;line-height:1.6;padding:0 8px;text-align:justify}

  /* Tracklist */
  .tracklist{max-width:980px;margin:28px auto;padding:18px;border-radius:12px;background:rgba(255,255,255,0.03);box-shadow:0 8px 30px rgba(0,0,0,.35)}
  .track{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-radius:10px;cursor:pointer;transition:transform .12s,box-shadow .12s,background .12s}
  .track:hover{transform:translateY(-4px);box-shadow:0 12px 30px rgba(0,0,0,.28);background:rgba(255,255,255,0.02)}
  .track .num{width:36px;text-align:center;color:#a8dede;font-weight:800}
  .track .title{font-weight:800;color:#fff;white-space:normal}
  .track .duration{color:#cfeeea}

  /* Mini player */
  #mini-player{position:fixed;left:12px;right:12px;bottom:12px;background:linear-gradient(90deg,#40E0D0,#0f4f54);padding:12px;border-radius:12px;display:none;align-items:center;justify-content:space-between;gap:12px;box-shadow:0 12px 36px rgba(0,0,0,.45);z-index:1500}
  .mini-left{display:flex;align-items:center;gap:12px;min-width:0}
  .mini-cover{width:66px;height:66px;border-radius:8px;object-fit:cover;box-shadow:0 8px 24px rgba(0,0,0,.4)}
  .mini-meta{overflow:hidden;min-width:0}
  .mini-title{font-weight:800;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:300px}
  #mini-time{color:#fff;font-weight:700;margin-left:6px;min-width:120px;text-align:right}
  .mini-controls{display:flex;align-items:center;gap:8px}
  .mini-controls button{width:44px;height:44px;border-radius:50%;background:#111;color:#fff;box-shadow:0 8px 20px rgba(0,0,0,.25);font-size:18px}

  /* Fullscreen player */
  #fullscreen-player{position:fixed;inset:0;display:none;align-items:flex-end;justify-content:flex-end;z-index:2000;background:#0f4f54;overflow:hidden}
  .bg-video-wrap{position:absolute;inset:0;z-index:0;overflow:hidden;opacity:0.16}
  .bg-video-wrap video{width:100%;height:100%;object-fit:cover;display:block;filter:blur(6px) saturate(.9)}
  #close-full{position:absolute;top:12px;right:12px;z-index:1600;background:rgba(0,0,0,0.55);color:#fff;padding:8px 10px;border-radius:8px;font-weight:700;cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,.4)}
  #fullscreen-info{position:relative;z-index:1500;width:100%;padding:22px 24px;background:linear-gradient(90deg, rgba(64,224,208,0.9), rgba(15,79,84,0.95));border-top-left-radius:16px;border-top-right-radius:16px;backdrop-filter:blur(6px)}
  .info-row{display:flex;align-items:center;justify-content:space-between;gap:16px}
  .title-big{font-size:1.5rem;font-weight:900;color:#fff;max-width:60%;line-height:1.05}
  .controls{display:flex;align-items:center;gap:12px}
  .controls button{width:48px;height:48px;border-radius:50%;background:#111;color:#fff;font-size:18px;box-shadow:0 8px 24px rgba(0,0,0,.3)}
  .controls button:hover{transform:scale(1.04);background:#40E0D0}
  #time-big{font-size:1.3rem;font-weight:900;color:#fff;min-width:140px;text-align:right}
  .progress-wrap{width:100%;margin-top:12px}
  .progress-bar{width:100%;height:12px;background:rgba(255,255,255,0.12);border-radius:8px;overflow:hidden;cursor:pointer}
  .progress-fill{height:100%;width:0%;background:#001; /* will be overridden by gradient */ background:linear-gradient(90deg,#40E0D0,#0ff);border-radius:8px;transition:width .06s linear}

  /* Lyrics area (inside fullscreen under progress) */
  .lyrics-container{margin-top:14px;max-height:38vh;overflow:auto;padding:8px 6px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));scrollbar-width:none}
  .lyrics-container::-webkit-scrollbar{display:none}
  .lyric-line{padding:6px 10px;color:#d6f6f3;border-radius:6px;transition:all .18s}
  .lyric-line.label{opacity:.9;color:#cdeeea;font-weight:700}
  .lyric-line.active{background:linear-gradient(90deg,#40E0D0,#0ff);color:#001;font-weight:900;transform:scale(1.01)}

  /* responsive */
  @media(max-width:720px){
    .title-big{font-size:1.1rem}
    #time-big{font-size:1rem}
    .lyrics-container{max-height:30vh}
  }
</style>
</head>
<body>

<header>
  <img class="hero" src="Dua_Lipa.jpg" alt="Dua Lipa" loading="lazy">
  <h1>Dua Lipa — Radical Optimism (2024)</h1>
  <p>
    Dua Lipa je britská zpěvačka, skladatelka a herečka (nar. 22.8.1995). Proslavila se debutem „Dua Lipa“ (2017) a dalším úspěchem „Future Nostalgia“ (2020). 
    Album <strong>Radical Optimism</strong> (2024) kombinuje taneční pop, disco a moderní elektroniku. Klikni na skladbu pro přehrávání a zobrazení synchronizovaných textů.
  </p>
</header>

<div class="tracklist" id="tracklist" aria-label="Seznam skladeb"></div>

<!-- Mini player -->
<div id="mini-player" aria-hidden="true">
  <div class="mini-left">
    <img id="mini-cover" class="mini-cover" src="radical_optimism.jpg" alt="cover" loading="lazy">
    <div class="mini-meta">
      <div id="mini-title" class="mini-title">—</div>
      <div id="mini-time">0:00 / 0:00</div>
    </div>
  </div>
  <div class="mini-controls">
    <button id="mini-prev" title="Předchozí">⏮</button>
    <button id="mini-play" title="Přehrát / Pauza">▶</button>
    <button id="mini-next" title="Další">⏭</button>
    <button id="mini-expand" title="Rozbalit">⬆</button>
  </div>
</div>

<!-- Fullscreen player -->
<div id="fullscreen-player" aria-hidden="true">
  <div class="bg-video-wrap" id="bg-video-wrap">
    <!-- optional visual - keep empty or set src dynamically -->
    <video id="bg-video" autoplay muted loop playsinline preload="none"></video>
  </div>

  <button id="close-full" title="Zavřít přehrávač">✖</button>

  <div id="fullscreen-info" aria-hidden="true">
    <div class="info-row">
      <div class="title-big" id="fs-title">—</div>
      <div style="display:flex;align-items:center;gap:12px">
        <div id="time-big">0:00 / 0:00</div>
        <div class="controls" role="group" aria-label="Ovládání">
          <button id="prev-btn" title="Předchozí">⏮</button>
          <button id="play-btn" title="Přehrát / Pauza">▶</button>
          <button id="next-btn" title="Další">⏭</button>
        </div>
      </div>
    </div>

    <div class="progress-wrap">
      <div class="progress-bar" id="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
    </div>

    <!-- Lyrics shown in fullscreen under the progress -->
    <div class="lyrics-container" id="lyrics-container" aria-live="polite"></div>
  </div>
</div>

<!-- Audio element (lazy loaded via JS src assignment on play) -->
<audio id="audio" preload="none"></audio>

<script>
/* ===== playlist - podle tvých dat (upravené cesty) ===== */
const tracks = [
  {num:1,title:"End Of An Era",mp3:"mech.mp3",mp4:"a82x20.mp4",duration:"3:15"},
  {num:2,title:"Houdini",mp3:"kouzelník.mp3",mp4:"a82xf4.mp4",duration:"3:08"},
  {num:3,title:"Training Season",mp3:"60m.mp3",mp4:"a82xvv.mp4",duration:"3:46"},
  {num:4,title:"These Walls",mp3:"zeď.mp3",mp4:"a82xxp.mp4",duration:"3:37"},
  {num:5,title:"Whatcha Doing",mp3:"Co.mp3",mp4:"a82ywb.mp4",duration:"3:17"},
  {num:6,title:"French Exit",mp3:"Francosisch.mp3",mp4:"a82yxv.mp4",duration:"3:21"},
  {num:7,title:"Illusion",mp3:"Iluze.mp3",mp4:"a82zdu.mp4",duration:"3:09"},
  {num:8,title:"Falling Forever",mp3:"Padat.mp3",mp4:"a82zjs.mp4",duration:"3:42"},
  {num:9,title:"Anything For Love",mp3:"Láska.mp3",mp4:"a82zlw.mp4",duration:"2:21"},
  {num:10,title:"Maria",mp3:"Marie.mp3",mp4:"a82zxw.mp4",duration:"3:07"},
  {num:11,title:"Happy For You",mp3:"Pro tebe.mp3",mp4:"a83003.mp4",duration:"4:04"}
];

/* ===== elements ===== */
const tracklistDiv = document.getElementById('tracklist');
const miniPlayer = document.getElementById('mini-player');
const miniTitle = document.getElementById('mini-title');
const miniCover = document.getElementById('mini-cover');
const miniPlay = document.getElementById('mini-play');
const miniPrev = document.getElementById('mini-prev');
const miniNext = document.getElementById('mini-next');
const miniExpand = document.getElementById('mini-expand');
const miniTime = document.getElementById('mini-time');

const fsPlayer = document.getElementById('fullscreen-player');
const fsTitle = document.getElementById('fs-title');
const bgVideo = document.getElementById('bg-video');
const closeFull = document.getElementById('close-full');
const playBtn = document.getElementById('play-btn');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const progressBar = document.getElementById('progress-bar');
const progressFill = document.getElementById('progress-fill');
const timeBig = document.getElementById('time-big');
const lyricsContainer = document.getElementById('lyrics-container');

const audio = document.getElementById('audio');

let currentIndex = null;
let lyricsMap = {}; // store lyrics per track index
let lyricNodes = []; // nodes for current lyrics
let lyricTimer = null;

/* ===== build tracklist in DOM ===== */
tracks.forEach(track => {
  const row = document.createElement('div');
  row.className = 'track fade-in';
  row.dataset.index = track.num - 1;
  row.innerHTML = `<div style="display:flex;gap:12px;align-items:center">
                     <div class="num">${track.num}</div>
                     <div class="title">${track.title}</div>
                   </div>
                   <div class="duration">${track.duration}</div>`;
  row.addEventListener('click', () => playTrack(track.num - 1));
  tracklistDiv.appendChild(row);
});

/* ===== sample synchronized lyrics for "Houdini" (track index 1) ===== */
/* Times in seconds approximate — uprav dle svého MP3 pokud chceš přesnější */
lyricsMap[1] = [
  {t:0, text:"[Intro]"},
  {t:4, text:"Okay"},
  {t:12, text:"Mm, ah"},
  {t:20.9, text:"[Chorus]"},
  {t:20.9, text:"I come and I go"},
  {t:23.0, text:"Tell me all the ways you need me"},
  {t:25.0, text:"I'm not here for long"},
  {t:27.0, text:"Catch me or I go Houdini"},
  {t:29.0, text:"I come and I go"},
  {t:31.2, text:"Prove you got the right to please me"},
  {t:33.1, text:"Everybody knows"},
  {t:35.1, text:"Catch me or I go Houdini"},
  {t:37.9, text:"[Verse 1]"},
  {t:37.9, text:"Time is passin' like a solar eclipse"},
  {t:41.7, text:"See you watchin' and you blow me a kiss"},
  {t:45.9, text:"It's your moment, baby, don't let it slip"},
  {t:50.1, text:"Come in closer, are you readin' my lips?"},
  {t:52.9, text:"[Chorus]"},
  {t:52.9, text:"They say I come and I go"},
  {t:55.7, text:"Tell me all the ways you need me"},
  {t:57.7, text:"I'm not here for long"},
  {t:59.7, text:"Catch me or I go Houdini"},
  {t:61.8, text:"I come and I go"},
  {t:63.9, text:"Prove you got the right to please me"},
  {t:66.0, text:"Everybody knows"},
  {t:68.0, text:"Catch me or I go Houdini"},
  {t:70.7, text:"[Post-Chorus]"},
  {t:70.7, text:"If you're good enough, you'll find the way"},
  {t:74.9, text:"Maybe you could cause a girl to change (Her ways)"},
  {t:79.0, text:"Do you think about it night and day?"},
  {t:83.1, text:"Maybe you could be the one to make me stay"},
  {t:87.3, text:"[Verse 2]"},
  {t:87.3, text:"Everything you say is soundin' so sweet (Ah-ah)"},
  {t:90.5, text:"But do you practise everything that you preach? (Ah-ah)"},
  {t:93.5, text:"I need something that'll make me believe (Ah-ah)"},
  {t:96.0, text:"If you got it, baby, give it to me"},
  {t:99.5, text:"[Chorus]"},
  {t:99.7, text:"They say I come and I go"},
  {t:102.2, text:"Tell me all the ways you need me"},
  {t:104.1, text:"I'm not here for long"},
  {t:106.0, text:"Catch me or I go Houdini"},
  {t:108.0, text:"I come and I go (I come and I go)"},
  {t:110.0, text:"Prove you got the right to please me"},
  {t:112.0, text:"Everybody knows (I'm not here for long)"},
  {t:114.0, text:"Catch me or I go Houdini"},
  {t:116.0, text:"[Bridge]"},
  {t:116.5, text:"Oh-oh"},
  {t:118.0, text:"Ooh"},
  {t:120.0, text:"[Chorus]"},
  {t:120.5, text:"I come and I go"},
  {t:122.5, text:"Tell me all the ways you need me (Ooh)"},
  {t:124.5, text:"I'm not here for long"},
  {t:126.5, text:"Catch me or I go Houdini"},
  {t:128.5, text:"I come and I go (I come and I go)"},
  {t:130.5, text:"Prove you got the right to please me"},
  {t:132.5, text:"Everybody knows (I'm not here for long)"},
  {t:134.0, text:"Catch me or I go Houdini"},
  {t:136.0, text:"[Outro]"},
  {t:136.5, text:"Houdini (Ah)"},
  {t:137.5, text:"Catch me or I go Houdini"}
];

/* ===== helpers ===== */
function formatTime(t){
  if(!t || isNaN(t)) return '0:00';
  const m = Math.floor(t/60);
  const s = Math.floor(t%60);
  return m+':' + (s<10 ? '0'+s : s);
}

/* ===== render lyrics into container (for current track) ===== */
function renderLyricsFor(index){
  lyricsContainer.innerHTML = '';
  lyricNodes = [];
  const lines = lyricsMap[index] || [];
  lines.forEach((ln,i) => {
    const div = document.createElement('div');
    div.className = (ln.text && ln.text.startsWith('[')) ? 'lyric-line label' : 'lyric-line';
    div.dataset.time = String(ln.t);
    div.textContent = ln.text;
    lyricsContainer.appendChild(div);
    lyricNodes.push(div);
  });
  // ensure scrollTop = 0
  lyricsContainer.scrollTop = 0;
}

/* ===== update highlight according to audio time and auto-scroll ===== */
function updateLyricsHighlight(){
  if(!lyricNodes.length) return;
  const ct = audio.currentTime;
  let activeIdx = -1;
  for(let i=0;i<lyricNodes.length;i++){
    const t = parseFloat(lyricNodes[i].dataset.time || 0);
    if(ct >= t) activeIdx = i;
    else break;
  }
  lyricNodes.forEach((n, idx) => {
    n.classList.toggle('active', idx === activeIdx);
  });
  if(activeIdx >= 0){
    const node = lyricNodes[activeIdx];
    // center the active node in lyrics container
    const container = lyricsContainer;
    const desired = node.offsetTop - (container.clientHeight/2) + (node.clientHeight/2);
    container.scrollTo({ top: desired, behavior: 'smooth' });
  }
}

/* ===== update UI buttons/time/progress ===== */
function updateUI(){
  const current = formatTime(audio.currentTime);
  const total = formatTime(audio.duration);
  timeBig.textContent = `${current} / ${total}`;
  miniTime.textContent = `${current} / ${total}`;
  const pct = audio.duration ? (audio.currentTime / audio.duration) * 100 : 0;
  progressFill.style.width = pct + '%';
  // play/pause text
  miniPlay.textContent = audio.paused ? '▶' : '⏸';
  playBtn.textContent = audio.paused ? '▶' : '⏸';
}

/* ===== main playback function: open fullscreen, lazy load audio/video, render lyrics ===== */
function playTrack(index){
  currentIndex = index;
  const t = tracks[index];
  // lazy load audio/video only on first play
  if(audio.src !== t.mp3) audio.src = t.mp3;
  // set video background (lazy)
  if(bgVideo && t.mp4){
    bgVideo.src = t.mp4;
    // keep video muted & low opacity; it shows as blurred background
  }
  // show mini player and fullscreen (we open fullscreen directly as requested)
  miniPlayer.style.display = 'flex';
  fsPlayer.style.display = 'flex';
  fsPlayer.setAttribute('aria-hidden','false');
  fsTitle.textContent = t.title;
  miniTitle.textContent = t.title;
  miniCover.src = t.cover || 'radical_optimism.jpg';
  // render lyrics for Houdini only (index 1), or empty for others
  renderLyricsFor(index);
  // play audio
  audio.play().catch(()=>{ /* autoplay may be blocked until user interacts; clicking track should allow */ });
  // update UI immediately
  updateUI();
}

/* ===== navigation controls ===== */
function playNext(){ if(currentIndex === null) currentIndex = 0; else currentIndex = (currentIndex + 1) % tracks.length; playTrack(currentIndex); }
function playPrev(){ if(currentIndex === null) currentIndex = 0; else currentIndex = (currentIndex - 1 + tracks.length) % tracks.length; playTrack(currentIndex); }

/* ===== wire up controls ===== */
miniPlay.addEventListener('click', () => {
  if(!audio.src){ // nothing loaded -> play selected default (Houdini if present)
    const idx = tracks.findIndex(t=>t.title.toLowerCase().includes('houdini')) ;
    playTrack(idx >= 0 ? idx : 0);
    return;
  }
  audio.paused ? audio.play() : audio.pause();
  updateUI();
});
miniPrev.addEventListener('click', playPrev);
miniNext.addEventListener('click', playNext);
miniExpand.addEventListener('click', ()=>{ fsPlayer.style.display = 'flex'; });

playBtn.addEventListener('click', ()=>{ audio.paused ? audio.play() : audio.pause(); updateUI(); });
prevBtn.addEventListener('click', playPrev);
nextBtn.addEventListener('click', playNext);

closeFull.addEventListener('click', ()=>{
  // hide fullscreen but keep audio running (user requested music continues)
  fsPlayer.style.display = 'none';
});

/* progress click / seek */
progressBar.addEventListener('click', (e) => {
  if(!audio.duration) return;
  const rect = progressBar.getBoundingClientRect();
  const x = Math.max(0, Math.min(e.clientX - rect.left, rect.width));
  audio.currentTime = (x / rect.width) * audio.duration;
  updateUI();
});

/* audio events */
audio.addEventListener('timeupdate', () => {
  updateUI();
  updateLyricsHighlight();
});
audio.addEventListener('play', updateUI);
audio.addEventListener('pause', updateUI);
audio.addEventListener('ended', ()=> {
  // auto next
  playNext();
});

/* prevent ugly behaviour on unload */
window.addEventListener('beforeunload', ()=>{ try{ audio.pause(); }catch(e){} });

/* initialize: hide fullscreen, mini hidden until a track is played */
fsPlayer.style.display = 'none';
miniPlayer.style.display = 'none';

/* Accessibility shortcut: space toggles play/pause when focused on body */
window.addEventListener('keydown', (e)=>{
  if(e.code === 'Space' && document.activeElement === document.body){
    e.preventDefault();
    if(audio.src) { audio.paused ? audio.play() : audio.pause(); updateUI(); }
  } else if(e.key === 'ArrowRight') playNext();
  else if(e.key === 'ArrowLeft') playPrev();
});
</script>
</body>
</html>
